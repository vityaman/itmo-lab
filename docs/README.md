# TiDB

## Model
```java
class Ticket {
    int id;                 // unique, autogenerated, positive
    String name;            // nonempty
    Coordinates coordinates;
    Date creationDate;      // autogenerated
    Optional<Integer> price;// positive
    TicketType type;
    Person person;
}

class Coordinates {
    double x;
    double y;               // max value - 762
}

class Person {
    int height;             // positive
    String passportID;      // length in [5, 47]
    Location location;
}

class Location {
    float x;
    double y;
    float z;
    String name;
}

enum TicketType {
    VIP,
    USUAL,
    CHEAP;
}
```


## JSON file sample
```json
{
    "nextId": 127,
    "list": [
        {
            "id": 126,
            "name": "Programming Lecture #1",
            "coordinates": {
                "x": 100,
                "y": 126
            },
            "creationDate": "10.03.2022 11:40:00",
            "type": "VIP",
            "person": {
                "height": 170,
                "passportId": "GFgfgHg78hG121ksSj23kOSs",
                "location": {
                    "x": 67,
                    "y": 124,
                    "z": 90,
                    "name": "ITMO University"
                }
            }
        },
        {
            "id": 101,
            "name": "VK Fest 2022",
            "coordinates": {
                "x": 39,
                "y": 89324
            },
            "creationDate": "23.05.2022 17:23:54",
            "price": 800,
            "type": "USUAL",
            "person": {
                "height": 168,
                "passportId": "HGfgH8Skpsn65Slsm3dzyiowk",
                "location": {
                    "x": 921,
                    "y": 123,
                    "z": 700,
                    "name": "Saint Petersburg"
                }
            }
        }
    ]
}
```
## Available simpleInterpreter
- **help** : вывести справку по доступным командам
- **info** : вывести в стандартный поток вывода информацию о коллекции (тип, дата инициализации, количество элементов и т.д.)
- **show** : вывести в стандартный поток вывода все элементы коллекции в строковом представлении
- **insert null {element}** : добавить новый элемент с заданным ключом
- **update id {element}** : обновить значение элемента коллекции, id которого равен заданному
- **remove_key null** : удалить элемент из коллекции по его ключу
- **clear** : очистить коллекцию
- **save** : сохранить коллекцию в файл
- **execute_script file_name** : считать и исполнить скрипт из указанного файла. В скрипте содержатся команды в таком же виде, в котором их вводит пользователь в интерактивном режиме.
- **exit** : завершить программу (без сохранения в файл)
- **remove_lower {element}** : удалить из коллекции все элементы, меньшие, чем заданный
- **history** : вывести последние 11 команд (без их аргументов)
- **remove_lower_key null** : удалить из коллекции все элементы, ключ которых меньше, чем заданный
- **group_counting_by_creation_date** : сгруппировать элементы коллекции по значению поля creationDate, вывести количество элементов в каждой группе
- **count_greater_than_person person** : вывести количество элементов, значение поля person которых больше заданного
- **filter_greater_than_type type** : вывести элементы, значение поля type которых больше заданного

## Example
Example, 10, 12, 12, VIP, 170, jfbsjdfsf, Home, 213, 12321, 2
insert (12, {
    name: "Example",
    coordinates: { x: 10, y: 12 },
    price: 12,
    type: "VIP",
    person: {
        height: 170,
        passportID: "asdandskdsaasdajs",
        location: { name: "Home",
            x: 213, y: 12321, "z": 2
        }
    }
}
)

update 12 {
    "coordinates": { "x": 12 }}
}

help

## Questions
- Using java.util.function instead of introducing my own interfaces

program
    instructions

instructions
    instruction
    instruction ws instructions

instruction
    chars ws
    chars ws values ws

values
    value
    value ',' values

value
    integer
    string
    object
    list

integer
    digits
    '-' digits

digits
    digit
    digit digits

digit
    '0' .. '9'

string
    char

chars
    char
    char chars

char
    'A' .. 'Z'
    'a' .. 'z'

object
    '{' chars ':' value '}'

list
    '\[' values '\]'

ws
    '\n'
    '\r'
    ' '
    '\t'
